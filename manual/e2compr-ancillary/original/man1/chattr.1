.\" -*- nroff -*-
.TH CHATTR 1 "December 1998" "E2fsprogs vers 1.12-e2c036"
.SH NAME
chattr \- change file attributes on a Linux second extended file system
.SH SYNOPSIS
.B chattr
[
.B \-ERV
]
[
.B -v
version
]
[
.B -b
cluster_size
]
[
.B -m
compression_method
]
[
mode
]
.I files...
.SH DESCRIPTION
.B chattr
changes the file attributes on a Linux second extended file system.
.PP
The format of a symbolic mode is +-=[ASXacdisu].
.PP
The operator `+' causes the selected attributes to be added to the
existing attributes of the files; `-' causes them to be removed; and
`=' causes them to be the only attributes that the files have.
.PP
The letters `ASXacdisu' select the new attributes for the files: 
don't update atime (A), synchronous updates (S), 
disable de/compression on I/O (X), append only (a), 
compressed (c), immutable (i), no dump (d),
secure deletion (s), and undeletable (u).  
The 'E' (compression error) attribute may only be cleared, not set.
.SH OPTIONS
.TP
.I -R
Recursively change attributes of directories and their contents.
.TP
.I -V
Verbosely describe changed attributes.
.TP
.I -v version
Set the files version.
.TP
.I -b cluster_size
Set the cluster size for compressed files.
The only supported cluster sizes are 4, 8, 16 or 32 blocks per cluster.
Depending on the file system and/or the kernel, some of these values
may not be supported.
.TP
.I -m compression_method
Set the algorithm used for compression.
Currently, the only supported algorithms are `lzv1', `lzrw3a' and
`gzip1', `gzip2', ..., `gzip9' where the number is equivalent to the
compression level used for gzip.
The name `lzv' is an alias for `lzv1', and `gzip' is an alias for `gzip6'.
Depending on the file system and/or the kernel, some of these values
may not be supported.
.SH ATTRIBUTES
When a file with the 'A' attribute set is modified, its atime record is
not modified.  This avoids a certain amount of disk I/O for laptop
systems.
.PP
A file with the `a' attribute set can only be open in append mode for writing.
Only the superuser can set or clear this attribute.
.PP
A file with the `c' attribute set is automatically compressed on the disk
by the kernel. A read from this file returns uncompressed data. A write to
this file is followed by an attempt to compress the data written.
.PP
Directories also can be marked with the `c' attribute; in such a case,
nothing is compressed, but any newly created file in the directory
will automatically be marked with the `c' attribute.  Similarly, a
directory can be given an algorithm name and/or cluster size, 
so that newly created files
will use this algorithm / cluster size.  
New files in the directory will only inherit
the flags if they get a new inode, not if they are simply given a new
link in that directory (e.g. with `mv' or `ln').
.PP
A file with the `d' attribute set is not candidate for backup when the
.BR dump (8)
program is run.
.PP
A file with the `i' attribute cannot be modified: it cannot be deleted or
renamed, no link can be created to this file and no data can be written
to the file. Only the superuser can set or clear this attribute.
.PP
When a file with the `s' attribute set is deleted, its blocks are
either zeroed or filled with random data (depending on the kernel
version) and written back to the disk.
.PP
When a file with the `S' attribute set is modified,
the changes are written synchronously on the disk; this is equivalent to
the `sync' mount option applied to a subset of the files.
.PP
When a file with the `u' attribute set is deleted, its contents are saved.
This allows the user to ask for its undeletion.
.PP
.SH AUTHOR
.B chattr
was originally
written by Remy Card <card@masi.ibp.fr>, the developer and maintainer
of the ext2 fs.
Modifications to display information related to file compression were
written by Antoine de Maricourt <dumesnil@etca.fr>.
.SH BUGS AND LIMITATIONS
As of ext2 fs 0.5a, the `u' attribute is not honoured by the kernel
code.  As of the Linux 2.0 kernel, the 'A' attribute is not supported by
the kernel code; but it is supported in the latest kernels.
.PP
The `c' attribute is implemented in the kernel for the ext2 fs 0.5a,
iff the e2compr patch has been applied.
The
.I -m
and 
.I -b
options are also accepted only if the patch has been applied.
.PP
It is currently not possible to change the cluster size for an already
compressed file.
You must first decompress the file, and then compress it again with
the new cluster size.
.PP
Changing the compression algorithm will not recompress the already
compressed clusters with the new algorithm.
Only newly written data will be compressed with the new algorithm.
If you want to recompress the complete file with the new algorithm,
you must first decompress it, and then recompress it with the new
algorithm.
.SH AVAILABILITY
This version of 
.B chattr
is part of the e2compr package,
found at <http://debs.fuller.edu/e2compr/software-03x.html>.
.SH SEE ALSO
.BR lsattr (1)
,
.BR e2compress (1)
,
.BR e2ratio (1)
,
.BR e2bitmap (1)
